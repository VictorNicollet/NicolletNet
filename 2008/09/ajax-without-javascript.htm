@title AJAX Without Javascript
@draft

AJAX is an acronym for Asynchronous Javascript And XML. It allows changing parts of a page based on data present on the server without having to reload the entire page.

The technical solution involves some javascript code that is executed by the browser and sends an HTTP request to the server. The server then responds with the appropriate data and the javascript code parses the data (originally in XML, now currently in the JSON serialized format) and displays it where required.

Writing AJAX by hand quickly became old, and instead several javascript libraries provide facilities to perform AJAX queries. One such library (used in this example) is jQuery.
<h2>The problem</h2>
AJAX still requires a reasonable amount of work both on the server and on the client. Server-side, the programmer has to set an access path so that the AJAX requests are received and handled, and must also handle the sending back of data to the page. Client-side, the programmer still has to specify what data to put where.

Let's consider a simple problem: a page has two buttons labeled "Increment" and "Reset", a numerical counter (which is incremented by the increment button and reset by the reset button), and a short sentence which describes how many times the counter has been reset.

Ideally, the page must satisfy that:
<ul>
	<li>Clicking the Increment button may only have to reload the two counters (the actual counter, and the increment count).</li>
	<li>Clicking the Reset button may only have to reload the actual counter, without touching the increment count.</li>
	<li>There should not be two code paths based on whether the page is being loaded through normal means or altered by clicks.</li>
	<li>Every button click must save the data on the server so that it sticks around on the next visit or when reloading.</li>
</ul>
<h2>The solution</h2>
In a clean MVC fashion, the Model is the <span style="font-family: courier new,courier; color: #999999;">$_SESSION</span> variable provided by PHP. The controller is a set of functions that alter and print the model:
<blockquote>
<pre style="background: #ffffff none repeat scroll 0% 50%; color: #000000;"><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">session_start</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">class</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> Controller</span>
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">{</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">  </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">function</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> url</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span> <span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">  {</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">return</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'http://www.example.com/mypage.php'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">}</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">  </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">function</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> incr</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span>  <span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">{</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$_SESSION</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">[</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'value'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">]</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">+</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">+</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$_SESSION</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">[</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'incr'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">]</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">+</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">+</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">}</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">  </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">function</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">reset(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span> <span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">{</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$_SESSION</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">[</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'value'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">]</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">=</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">0</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">}</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">  </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">function</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">value(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span> <span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">{</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">return</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">string</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$_SESSION</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">[</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'value'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">]</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">}</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">  </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">function</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> incrs</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span> <span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">{</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">return</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">string</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$_SESSION</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">[</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'incr'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">]</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">}</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">}</span></pre>
</blockquote>
And the view is a special script that is to be compiled by a special compiler:
<blockquote>
<pre style="background: #ffffff none repeat scroll 0% 50%; color: #000000;"><span style="color: #7f0055;">&lt;</span><span style="color: #000084; font-weight: bold;">html</span><span style="color: #7f0055;">&gt;</span> 
  <span style="color: #7f0055;">&lt;</span><span style="color: #000084; font-weight: bold;">head</span><span style="color: #7f0055;">&gt;</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #7f0055;">&lt;?</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">this</span> -<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">&gt;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> action</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'js_incr'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">,</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'incr'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">,</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">  </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">array</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'value'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">,</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'incrs'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">      </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">-</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">&gt;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> action</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'js_reset'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">,</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'reset'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">,</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">array</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'value'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #7f0055;">?&gt;</span> 
    <span style="color: #7f0055;">&lt;</span><span style="color: #000084; font-weight: bold;">title</span><span style="color: #7f0055;">&gt;</span>Example page<span style="color: #7f0055;">&lt;/</span><span style="color: #000084; font-weight: bold;">title</span><span style="color: #7f0055;">&gt;</span> 
  <span style="color: #7f0055;">&lt;/</span><span style="color: #000084; font-weight: bold;">head</span><span style="color: #7f0055;">&gt;</span> 
  <span style="color: #7f0055;">&lt;</span><span style="color: #000084; font-weight: bold;">body</span><span style="color: #7f0055;">&gt;</span> 
<span style="color: #7f0055;">&lt;</span><span style="color: #000084; font-weight: bold;">ul</span><span style="color: #7f0055;">&gt;</span> 
  <span style="color: #7f0055;">&lt;</span><span style="color: #000084; font-weight: bold;">li</span><span style="color: #7f0055;">&gt;</span> 
    <span style="color: #7f0055;">&lt;</span><span style="color: #000084; font-weight: bold;">button</span> onclick=<span style="color: #0000ff;">"js_incr({})"</span><span style="color: #7f0055;">&gt;</span>Increment<span style="color: #7f0055;">&lt;/</span><span style="color: #000084; font-weight: bold;">button</span><span style="color: #7f0055;">&gt;</span> 
    <span style="color: #7f0055;">&lt;</span><span style="color: #000084; font-weight: bold;">button</span> onclick=<span style="color: #0000ff;">"js_reset({})"</span><span style="color: #7f0055;">&gt;</span>Reset<span style="color: #7f0055;">&lt;/</span><span style="color: #000084; font-weight: bold;">button</span><span style="color: #7f0055;">&gt;</span> 
  <span style="color: #7f0055;">&lt;/</span><span style="color: #000084; font-weight: bold;">li</span><span style="color: #7f0055;">&gt;</span> 
  <span style="color: #7f0055;">&lt;</span><span style="color: #000084; font-weight: bold;">li</span><span style="color: #7f0055;">&gt;</span> 
    The value is <span style="background: #ffffe8 none repeat scroll 0% 50%; color: #7f0055;">&lt;?</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">this</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">-</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">&gt;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> span</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'value'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #7f0055;">?&gt;</span>. 
  <span style="color: #7f0055;">&lt;/</span><span style="color: #000084; font-weight: bold;">li</span><span style="color: #7f0055;">&gt;</span> 
  <span style="color: #7f0055;">&lt;</span><span style="color: #000084; font-weight: bold;">li</span><span style="color: #7f0055;">&gt;</span> 
    The value has been incremented <span style="background: #ffffe8 none repeat scroll 0% 50%; color: #7f0055;">&lt;?</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">this</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">-</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">&gt;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> span</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'incrs'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #7f0055;">?&gt;</span> times. 
  <span style="color: #7f0055;">&lt;/</span><span style="color: #000084; font-weight: bold;">li</span><span style="color: #7f0055;">&gt;</span> 
<span style="color: #7f0055;">&lt;/</span><span style="color: #000084; font-weight: bold;">ul</span><span style="color: #7f0055;">&gt;</span> 
  <span style="color: #7f0055;">&lt;/</span><span style="color: #000084; font-weight: bold;">body</span><span style="color: #7f0055;">&gt;</span> 
<span style="color: #7f0055;">&lt;/</span><span style="color: #000084; font-weight: bold;">html</span><span style="color: #7f0055;">&gt;</span></pre>
</blockquote>
The compiler itself is run as follows (of course, it's also possible to save the compiled code to a file and load it without having to compile it again):
<blockquote>
<pre style="background: #ffffff none repeat scroll 0% 50%; color: #000000;"><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">require_once</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'AjaxCompiler.php'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$compiler</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">=</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">new</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> AjaxCompiler</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #0000ff;">'view.php'</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span> 
<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$ajax</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">=</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$compiler</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">-</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">&gt;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> getCompiledObject</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span> 

<span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">print</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$ajax</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">-</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">&gt;</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> react</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">(</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">$_POST</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">,</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> </span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000084; font-weight: bold;">new</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;"> Controller()</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">)</span><span style="background: #ffffe8 none repeat scroll 0% 50%; color: #000000;">;</span></pre>
</blockquote>
The compiler executes the file, keeping everything in HTML format but replacing the function calls with the appropriate data. The action function specifies that a javascript function (named after the first argument) must send all its arguments to a PHP function on the server (named after the second argument) that is a member function of the controller (the controller is the second argument to the <span style="font-family: courier new,courier; color: #999999;">$ajax -&gt; react()</span> call) and return that function's output converted to javascript, then refresh the spans and divs named in its third argument.

Spans and divs are generated with the appropriately named functions of the controller (which may use any means of rendering seen fit) and sent along with the AJAX response to the original query so that they are replaced in the XHTML document. All the binding is done automatically by the compiler, so that the same functions are used for generation both in normal querying mode and in AJAX mode, and yield identical results for normal XHTML.
<h2>Work in progress</h2>
Many things remain to be done. hierarchical AJAX documents are still not possible, nor are parametric spans and divs (for instance, for editing individual elements of a list of elements). Also, the system has not yet been tested with javascript-enabled data in those spans and divs that are se